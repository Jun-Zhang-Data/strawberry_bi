version: 2

models:
  - name: stg_pms_reservations
    description: "Bronze staging table for PMS reservations (JSON ingested from RAW)."

    columns:
      - name: RESERVATION_ID
        tests:
          - not_null
          - unique 

      - name: TOTAL_AMOUNT_GROSS
        description: "Total reservation amount including taxes/fees (gross)"
        tests:
          - column_is_numeric

    tests:
      - expected_columns:
          expected_columns:
            - RESERVATION_ID
            - RESERVATION_NO
            - RESERVATION_DATE
            - UPDATED_TIME_UTC
            - MEMBER_ID
            - HOTEL_ID
            - BOOKING_START_DATE
            - BOOKING_END_DATE
            - STATUS_CODE
            - ROOM_RATE
            - TOTAL_AMOUNT_GROSS
            - SRC_FILE_NAME
            - LOAD_TS_UTC




